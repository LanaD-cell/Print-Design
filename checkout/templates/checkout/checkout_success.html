{% extends "base.html" %}
{% load static %}
{% load crispy_forms_tags %}

{% block corejs %}
<!-- Your stripe_elements.js file -->
<script src="{% static 'checkout/js/stripe_elements.js' %}" defer></script>
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'checkout/css/checkout.css' %}">
{% endblock %}

{% block page_header %}
<div class="container header-container">
    <div class="row">
        <div class="col"></div>
    </div>
</div>
{% endblock %}

{% block content %}
<div class="overlay"></div>
<div class="container">
    <div class="row">
        <div class="col">
            <hr>
            <h2 class="logo-font mb-4">Thank you</h2>
            <hr>
            <p>Your order information is below.
                A confirmation email will be sent to <strong>{{ order.email }}</strong>.</p>
        </div>
    </div>

    <div class="row">
        <div class="col-12 col-lg-7"></div>
    </div>

    <div class="text-center mt-4">
        <a href="{% url 'products' %}" class="btn btn-primary">Continue Shopping</a>
        <span class="icon mr-2">
            <i class="fa-solid fa-cart-plus"></i>
        </span>
        <span class="text-uppercase">Have a look at some of our awesome products!</span>
    </div>

    {% if free_delivery_qualified %}
    <!-- Confetti effect when user qualifies for free delivery -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.0/dist/confetti.browser.min.js"></script>
    <script>
        // Function to trigger the confetti
        function launchConfetti() {
            var duration = 3 * 1000;
            var end = Date.now() + duration;
            var colors = ['#ff0', '#0f0', '#f00', '#00f', '#f0f'];

            (function frame() {
                confetti({
                    particleCount: 5,
                    angle: Math.random() * 360,
                    spread: Math.random() * 60 + 10,
                    origin: {
                        x: Math.random(),
                        y: Math.random()
                    },
                    colors: colors
                });

                if (Date.now() < end) {
                    requestAnimationFrame(frame);
                }
            })();
        }

        launchConfetti();
    </script>
    {% endif %}

</div>
{% endblock %}
